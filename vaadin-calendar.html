<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../vaadin-grid/vaadin-grid.html">
<link rel="import" href="../iron-ajax/iron-ajax.html">
<link rel="import" href="../iron-selector/iron-selector.html">
<link rel="import" href="day-of-month.html">

<style>
    .month {
        font-size: 200%;
    }

    .calendar-cell {
        border-right: 1px solid #e3e3e3;
        align-items: flex-start !important;
        padding: 5px !important;
    }

    .weekend {
        background-color: #ededed !important;
    }

    day-of-month {
        width: 100%;
    }

    vaadin-grid .vaadin-grid-body tr {
        height: 150px !important;
    }

    /* selection by click doesn't work for some reason */
    .iron-selected {
        background-color: red;
        color: white;
        font-weight: bold;
    }
</style>

<dom-module id="vaadin-calendar">

    <style>
        :host {
            font-family: Roboto, sans-serif
        }
    </style>

    <template>
        <!--<iron-ajax url="data/calendar.json" last-response="{{data}}" auto></iron-ajax>-->

        <div class="month">November 2015</div>
        <vaadin-grid id="grid" selection-mode="disabled" items="[[data]]">
            <table>
                <colgroup>
                    <col header-text="Mon" flex="1">
                    <col header-text="Tue" flex="1">
                    <col header-text="Wed" flex="1">
                    <col header-text="Thu" flex="1">
                    <col header-text="Fri" flex="1">
                    <col header-text="Sat" flex="1">
                    <col header-text="Sun" flex="1">
                </colgroup>
            </table>
        </vaadin-grid>
    </template>
</dom-module>

<script>
    HTMLImports.whenReady(function () {
        Polymer({
            is: 'vaadin-calendar',

            properties: {
                data: {
                    type: Array,
                    notify: true
                }
            },

            ready: function() {
                this.$.grid.rowClassGenerator = function (row) {
                    return 'calendar-row';
                };

                this.$.grid.cellClassGenerator = function (cell) {
                    if (cell.index >= 5) {
                        return 'calendar-cell weekend';
                    }
                    return 'calendar-cell';
                };

                this.$.grid.columns.forEach(function(column) {
                    column.renderer= function(cell) {
                        var data = cell.row.data.days[cell.index];
                        cell.element.innerHTML = '';
                        var child = document.createElement('day-of-month');
                        child.setAttribute('day', data.day);
                        child.events = data.events;
                        cell.element.appendChild(child);
                    }
                });
            }
        });
    });
</script>